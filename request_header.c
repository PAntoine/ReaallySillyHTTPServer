/*--------------------------------------------------------------------------------*
 * Name: Parser Look-up tree
 * Desc: function and data structures to speed up a specific string search
 *
 *         **** DO NOT AMEND THIS CODE - IT IS AUTO_GENERATED ****
 *
 * Code and table produced by:
 *            build_graph 
 *            version 0.1
 *
 *  written by Peter Antoine. 
 *--------------------------------------------------------------------------------*/

#include "request_header.h"

REQUEST_HEADER_STRING_TABLE	request_header_table[20] = {
		{"Accept",6},
		{"Accept-Charset",14},
		{"Accept-Encoding",15},
		{"Authorization",13},
		{"Expect",6},
		{"From",4},
		{"Host",4},
		{"If-Match",8},
		{"If-Modified-Since",17},
		{"If-Range",8},
		{"If-Unmodified-Since",19},
		{"Max-Forwards",12},
		{"Proxy-Authorization",19},
		{"Range",5},
		{"Referer",7},
		{"If-None-Match",13},
		{"TE",2},
		{"Accept-Language",15},
		{"User-Agent",10},
		{"Keep-Alive",10}
};

static char	symbol_table[256] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x06,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x01,0x00,0x07,0x00,0x0C,0x15,0x00,0x17,0x18,0x00,0x24,0x23,0x1A,0x21,0x00,
								 0x1F,0x00,0x1C,0x1B,0x22,0x1D,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x09,0x00,0x02,0x0F,0x03,0x19,0x11,0x08,0x10,0x00,0x00,0x25,0x16,0x0D,0x0E,
								 0x04,0x00,0x0A,0x0B,0x05,0x12,0x26,0x1E,0x14,0x20,0x13,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

static char	state_machine_table[14][38] = {
								{0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFB,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0xFA,0x00,0xF9,0x09,0x00,0xF4,0x00,0x0D,0xED,0x00,0xF3,
								 0x00,0x00,0xEF,0x00,0xEC,0x00},
								{0x00,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0xFC,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0xFF,0x00,0x00,0x00,0x00,0x00,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFE,0x00,0x00,0x00,0x00,0xFD,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0xEE,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0A,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x0B,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0C,0x00,0xF6,0xF5,0x00,0x00,
								 0x00,0xF0,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x00,0x00,0x00,0x00,0xF7,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00},
								{0x00,0x00,0x00,0xF1,0x00,0x00,0x00,0x00,0x00,0xF2,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
								 0x00,0x00,0x00,0x00,0x00,0x00}};


int	request_header_check_word(char* word)
{
	int	line = 0;
	int	count = 0;
	int letter = 0;

	do
	{
		line = state_machine_table[line][symbol_table[word[letter]]];
		letter++;
	}
	while (line > 0 && word[letter] != '\0');

	if (line < 0)
		line = (0-line) - 1;
	else if ((line = state_machine_table[line][symbol_table[0]]) < 0)
		line = (0-line) - 1;
	else
		line = -1;

	if (line >= 0)
	{
		for (count=letter;count < request_header_table[line].length;count++)
		{
			if (word[count] != request_header_table[line].name[count])
			{
				line = -1;
				break;
			}
		}
	}
	return line;
}
